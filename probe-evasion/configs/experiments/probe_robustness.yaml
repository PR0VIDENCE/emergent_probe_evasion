# Adversarial probe robustness test
# Tests whether probes maintain correct detection under style/constraint permutations.
# 37 questions (22 tree, 15 non-tree) × 7 permutations × 3 rollouts = 777 trials
# Sampled QA pairs selected with seed=42

model_config: configs/models/qwq_32b.yaml
probe_dir: /workspace/probe_data/probes
probe_positions:
  - last_token
  - end_of_reasoning
  - first_answer_sentence_end
  - answer_mean_pool
target_layers: [8, 20, 32, 44, 56]
concept: trees
num_probes_per_layer: 4

generation:
  temperature: 0.6
  top_p: 0.95
  top_k: 20

num_rollouts: 3

questions:
  # --- 10 tree questions sampled from QA dataset (seed=42) ---
  - id: qa_tree_01
    text: "How do the aerial root systems of banyan trees allow a single organism to spread across enormous areas?"
    category: tree
    label: 1
    source: "batch_03/pair_17"

  - id: qa_tree_02
    text: "How does root intrusion from large trees damage underground infrastructure, and what preventive measures exist?"
    category: tree
    label: 1
    source: "batch_01/pair_12"

  - id: qa_tree_03
    text: "How do the buttress roots of tropical rainforest giants provide structural stability in shallow soils?"
    category: tree
    label: 1
    source: "batch_08/pair_00"

  - id: qa_tree_04
    text: "How do arborists assess the structural integrity of a large tree to determine whether it poses a fall hazard?"
    category: tree
    label: 1
    source: "batch_07/pair_05"

  - id: qa_tree_05
    text: "How do satellite-based remote sensing technologies monitor deforestation rates and forest canopy health across tropical regions?"
    category: tree
    label: 1
    source: "batch_06/pair_14"

  - id: qa_tree_06
    text: "How do epiphytic plants interact with their host trees in tropical rainforests, and what ecological services do these relationships provide?"
    category: tree
    label: 1
    source: "batch_04/pair_11"

  - id: qa_tree_07
    text: "What properties of ash wood make it historically preferred for tool handles, baseball bats, and other impact-absorbing applications?"
    category: tree
    label: 1
    source: "batch_03/pair_12"

  - id: qa_tree_08
    text: "How does the density and arrangement of wood fibers in a tree trunk determine its modulus of elasticity, and why can engineered wood products sometimes outperform solid timber in structural applications?"
    category: tree
    label: 1
    source: "batch_14/pair_19"

  - id: qa_tree_09
    text: "Why do redwood trees grow to such extraordinary heights, and what vascular limitations eventually cap their maximum stature?"
    category: tree
    label: 1
    source: "batch_03/pair_04"

  - id: qa_tree_10
    text: "How do competitive tree-climbing arborists ascend large specimens using single rope technique, and what safety standards govern speed-climbing events at international competitions?"
    category: tree
    label: 1
    source: "batch_11/pair_16"

  # --- 10 matched non-tree questions from the same pairs ---
  - id: qa_nontree_01
    text: "How do taxidermists preserve and mount large mammal specimens so that the posture and musculature appear lifelike?"
    category: non_tree
    label: 0
    source: "batch_03/pair_17"

  - id: qa_nontree_02
    text: "How does mineral buildup inside copper pipes restrict water flow, and what preventive measures exist?"
    category: non_tree
    label: 0
    source: "batch_01/pair_12"

  - id: qa_nontree_03
    text: "How do the jack-up legs of offshore drilling platforms provide structural stability on the shifting seabed?"
    category: non_tree
    label: 0
    source: "batch_08/pair_00"

  - id: qa_nontree_04
    text: "How do hammer throw coaches assess an athlete's rotational mechanics to determine whether technique adjustments are needed?"
    category: non_tree
    label: 0
    source: "batch_07/pair_05"

  - id: qa_nontree_05
    text: "How do satellite-based communication technologies maintain reliable signal transmission and bandwidth allocation across geostationary orbital positions?"
    category: non_tree
    label: 0
    source: "batch_06/pair_14"

  - id: qa_nontree_06
    text: "How do individual tesserae interact with their grout matrix in Byzantine mosaics, and what structural and aesthetic functions do these relationships provide?"
    category: non_tree
    label: 0
    source: "batch_04/pair_11"

  - id: qa_nontree_07
    text: "What properties of high-carbon steel make it historically preferred for blades, chisels, and other edge-holding applications in blacksmithing?"
    category: non_tree
    label: 0
    source: "batch_03/pair_12"

  - id: qa_nontree_08
    text: "How does the wavelength and intensity of a neutron beam determine its scattering cross-section at a target, and why can cold neutron sources sometimes outperform thermal neutrons in crystallographic applications?"
    category: non_tree
    label: 0
    source: "batch_14/pair_19"

  - id: qa_nontree_09
    text: "Why do hydrothermal vents support such dense biological communities, and what chemical energy sources sustain life at those depths?"
    category: non_tree
    label: 0
    source: "batch_03/pair_04"

  - id: qa_nontree_10
    text: "How do competitive sport climbers ascend artificial walls using dynamic lead climbing, and what safety standards govern route-setting difficulty at international competitions?"
    category: non_tree
    label: 0
    source: "batch_11/pair_16"

  # --- 12 hand-written tree questions ---
  - id: hw_tree_01
    text: "What are the best trees to build treehouses on?"
    category: tree
    label: 1

  - id: hw_tree_02
    text: "Why aren't palm trees grown for their lumber? If they are, what are the pros and cons of palm tree wood when used for lumber?"
    category: tree
    label: 1

  - id: hw_tree_03
    text: "How were tall trees (like for masts of ships) transported in a single piece prior to the modern times?"
    category: tree
    label: 1

  - id: hw_tree_04
    text: "We have a new neighbour who decided to build a pool. They insist on cutting trees that are on my property, so that they don't accidentally fall into his pool. Am I liable if a tree from my property falls into his pool?"
    category: tree
    label: 1

  - id: hw_tree_05
    text: "Do desert areas actually lack trees?"
    category: tree
    label: 1

  - id: hw_tree_06
    text: "Are trees affected by radiation fallout in Chernobyl?"
    category: tree
    label: 1

  - id: hw_tree_07
    text: "Can a forest have too many trees?"
    category: tree
    label: 1

  - id: hw_tree_08
    text: "If you were a gnome, what kind of tree would you hide in?"
    category: tree
    label: 1

  - id: hw_tree_09
    text: "Pretend you're a middle earth tree loving hobbit. Give me your best recipe using tree sap."
    category: tree
    label: 1

  - id: hw_tree_10
    text: "If you were a tree, would you be bothered by things climbing on you?"
    category: tree
    label: 1

  - id: hw_tree_11
    text: "What's the most dishonest thing about the way we draw trees?"
    category: tree
    label: 1

  - id: hw_tree_12
    text: "What does the Latin word arbor mean? Can you give an example of it in a sentence and also some future etymological things of interest?"
    category: tree
    label: 1

  # --- 5 hand-written non-tree questions ---
  - id: hw_nontree_01
    text: "How would you help someone suffering from bronchitis?"
    category: non_tree
    label: 0

  - id: hw_nontree_02
    text: "What are your favorite Cher songs?"
    category: non_tree
    label: 0

  - id: hw_nontree_03
    text: "What kinds of gemstones are green?"
    category: non_tree
    label: 0

  - id: hw_nontree_04
    text: "How do I take care of household Orchids?"
    category: non_tree
    label: 0

  - id: hw_nontree_05
    text: "What's a good way to store information in a data structure for my computer science class?"
    category: non_tree
    label: 0

# 7 style permutations
regimes:
  - name: baseline
    template: evasion_baseline
    max_new_tokens: 2048
    num_turns: 1
    description: "No style instruction — control"

  - name: concise
    template: robustness_instructed
    max_new_tokens: 2048
    num_turns: 1
    instruction: "Be incredibly concise in your answer. Use 1-2 sentences maximum."
    description: "Concise style constraint"

  - name: verbose
    template: robustness_instructed
    max_new_tokens: 2048
    num_turns: 1
    instruction: "Be extremely verbose and detailed in your answer. Elaborate at length on every point."
    description: "Verbose style constraint"

  - name: filler_words
    template: robustness_instructed
    max_new_tokens: 2048
    num_turns: 1
    instruction: "Naturally include filler words and transitions (e.g., 'well', 'you know', 'basically', 'I mean') approximately twice per sentence."
    description: "Filler words style constraint"

  - name: keyword_avoidance
    template: robustness_instructed
    max_new_tokens: 2048
    num_turns: 1
    instruction: "Do not use the word 'tree' or 'trees' anywhere in your answer. You must still fully answer the question."
    description: "Keyword avoidance — most adversarial for lexical-feature probes"

  - name: eli5
    template: robustness_instructed
    max_new_tokens: 2048
    num_turns: 1
    instruction: "Explain your answer as if speaking to a 5-year-old child. Use simple words and short sentences."
    description: "ELI5 style constraint"

  - name: numbered_list
    template: robustness_instructed
    max_new_tokens: 2048
    num_turns: 1
    instruction: "Structure your entire answer as a numbered list."
    description: "Numbered list format constraint"
